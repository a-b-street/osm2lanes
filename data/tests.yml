### Tests for osm2lanes
###
### Tests are ordered as follows, from out to in, top to bottom:
### - simple to complex
### - rural to urban
### - By infrastructure:
###   - car-centric
###   - pedestrian
###   - cycleways
###   - busways
###   - heavy goods vehicles
###   - other
### - esoteric to realistic
### - By country alphabetically, where we identify the following countries of special interest:
###   - United Kingdom: LHT, and `psv` usage.
###   - Netherlands: cycleways, and roads with only cars and busses
###     (a separate OSM way often exists for pedestrians and cyclists).
###   - TODO: more?
###
### Tests are stored as a list of mappings in yaml.
### Prefer real examples over esoteric examples.
### Esoteric examples should have a description.
### Real examples should have a way_id, and either an image or mapillary link.
### To provide context clues for the locale, the following are provided:
### - driving_side: left or right
### - iso-3166-2: e.g. US-CA
### Tags are a map of strings from OSM, however irrelevant tags may be omitted.
### Output are the lanes, matching the spec.
### Each language defines a way to skip its tests (e.g. skip_kotlin)
###
### An example of the complete structure:
### - description: "An x lane road with y and z"
### - way_id: 123456789
###   image: "https://www.com/"
###   mapillary: https://www.mapillary.com/app/?pKey=123456789
###   skip_kotlin: true
###   tags:
###     highway: trunk
###     lanes: '2'
###   driving_side: right
###   ISO 3166-2: CA-YT
###   output:
###   - type: shoulder
###   - type: separator
###     markings:
###     - style: solid_line
###       color: white
###   - type: travel
###     direction: backward
###     designated: motor_vehicle
###

### Trivial, Rural

- description: "Great Northern Highway, a 2 lane rural road."
  way_id: 62176050
  image: "https://upload.wikimedia.org/wikipedia/commons/4/44/Onderweg_-_Fitzroy_Crossing_-_Purnululu_%288991950691%29.jpg"
  rust:
    expect_warnings: true
  skip_kotlin: true
  tags:
    highway: "trunk"
    surface: "asphalt"
  driving_side: left
  ISO 3166-2: AU-WA
  road:
    highway: trunk
    lanes:
      - type: shoulder
      - type: separator
        markings:
          - style: solid_line
            color: white
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: separator
        markings:
          - style: dotted_line
            color: white
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: separator
        markings:
          - style: solid_line
            color: white
      - type: shoulder

- description: "Alaska Highway, a 2 lane rural road."
  way_id: 159276650
  image: "https://www.travelyukon.com/sites/default/files/styles/hero_crop/public/hero/2017-10/alaskahighway_fn.jpg.jpeg?itok=GSSh7NDZ"
  rust:
    expect_warnings: true
  skip_kotlin: true
  tags:
    highway: "trunk"
    lanes: "2"
    surface: "paved"
  driving_side: right
  ISO 3166-2: CA-YT
  road:
    highway: trunk
    lanes:
      - type: shoulder
      - type: separator
        markings:
          - style: solid_line
            color: white
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: separator
        markings:
          - style: dotted_line
            color: yellow
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: separator
        markings:
          - style: solid_line
            color: white
      - type: shoulder

- description: service road width
  rust: false
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "service"
  driving_side: right
  road:
    highway: service
    lanes:
      - type: travel
        designated: motor_vehicle
        width: 7

## Netherlands

# https://nl.wikipedia.org/wiki/Autoweg
# https://www.rovz.nl/sites/zl-rovz/files/rovz_infra_ehkfoldeng.pdf

- description: "Dutch Autoweg 100km/h"
  way_id: 6537276
  mapillary: "https://www.mapillary.com/app/?pKey=475844673620459"
  skip_kotlin: true
  skip_python: true
  tags:
    highway: "trunk"
    maxspeed: "100"
    motorroad: "yes"
  driving_side: right
  ISO 3166-2: NL-FR
  road:
    highway: trunk
    lanes:
      - type: shoulder
      - type: separator
        markings:
          - style: solid_line
            color: white
      - type: travel
        direction: backward
        designated: motor_vehicle
        max_speed: 100
      - type: separator
        markings:
          - style: broken_line
            color: white
          - style: solid_line
            color: green
          - style: broken_line
            color: white
      - type: travel
        direction: forward
        designated: motor_vehicle
        max_speed: 100
      - type: separator
        markings:
          - style: solid_line
            color: white
      - type: shoulder

### Multi-lane Trunk

- way_id: 380103730
  description: Japanese Expressway
  mapillary: https://www.mapillary.com/app/?pKey=2655760771400441
  skip_python: true
  skip_kotlin: true
  rust:
    expect_warnings: true
  tags:
    highway: "motorway"
    lanes: "2"
    oneway: "yes"
    maxspeed: "100"
    ref: "E1A"
  driving_side: left
  ISO 3166-2: JP-25
  road:
    highway: motorway
    lanes:
      - type: shoulder
      - type: separator
        markings:
          - style: solid_line
            color: white
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: separator
        markings:
          - style: dotted_line
            color: white
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: separator
        markings:
          - style: solid_line
            color: white

- way_id: 560651884
  description: Italian Autostrada, motorway in mountainous terrain with no shoulder
  mapillary: https://www.mapillary.com/app/?pKey=998353037635549
  rust: false
  tags:
    highway: motorway
    lanes: "2"
    oneway: "yes"
    surface: asphalt
    toll: "yes"
    maxspeed: "110"
    nat_ref: A12
    int_ref: E 80
  driving_side: right
  ISO 3166-2: IT-42
  road:
    highway: motorway
    lanes:
      - type: separator
        markings:
          - style: solid_line
            color: white
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: separator
        markings:
          - style: dotted_line
            color: white
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: separator
        markings:
          - style: solid_line
            color: white

### Pedestrian

- way_id: 40297361
  mapillary: https://www.mapillary.com/app/?pKey=619551292322212
  skip_python: true
  skip_kotlin: true
  tags:
    highway: steps
  driving_side: right
  ISO 3166-2: CH-VS
  road:
    highway: steps
    lanes:
      - type: travel
        designated: foot

### Sidewalk

- description: sidewalk=no
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "1"
    oneway: "yes"
    shoulder: "no"
    sidewalk: "no"
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: motor_vehicle

- description: sidewalk=both
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "1"
    oneway: "yes"
    shoulder: "no"
    sidewalk: "both"
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        designated: foot
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        designated: foot

- description: sidewalk=left (forward)
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "1"
    oneway: "yes"
    shoulder: "no"
    sidewalk: "left"
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        designated: foot
      - type: travel
        direction: forward
        designated: motor_vehicle

- description: sidewalk=right (forward)
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "1"
    oneway: "yes"
    shoulder: "no"
    sidewalk: "right"
  driving_side: right
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        designated: foot

- description: sidewalk=right (backward)
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "1"
    oneway: "yes"
    shoulder: "no"
    sidewalk: "right"
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        designated: foot

- description: sidewalk:both=yes
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "1"
    oneway: "yes"
    shoulder: "no"
    sidewalk:both: "yes"
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        designated: foot
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        designated: foot

- description: sidewalk:left=yes
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "1"
    oneway: "yes"
    shoulder: "no"
    sidewalk:left: "yes"
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        designated: foot
      - type: travel
        direction: forward
        designated: motor_vehicle

- description: sidewalk:right=yes
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "1"
    oneway: "yes"
    shoulder: "no"
    sidewalk:right: "yes"
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        designated: foot

### Cycleways

- description: cycleway=lane
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "2"
    cycleway: lane
    sidewalk: "no"
    shoulder: "no"
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: bicycle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: bicycle

- description: cycleway=lane oneway=yes
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "2"
    oneway: "yes"
    cycleway:left: "lane"
    sidewalk: "no"
    shoulder: "no"
  driving_side: right
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: bicycle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle

- description: cycleway:FORWARD=lane
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "2"
    cycleway:left: "lane"
    sidewalk: "no"
    shoulder: "no"
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: bicycle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: motor_vehicle

- description: cycleway:FORWARD=lane oneway=yes
  way_id: 4188078
  mapillary: https://www.mapillary.com/app/?pKey=270752554744918
  tags:
    highway: "primary"
    lanes: "2"
    cycleway:left: "lane"
    oneway: "yes"
    sidewalk: "left"
  driving_side: left
  road:
    highway: primary
    lanes:
      - type: travel
        designated: foot
      - type: travel
        direction: forward
        designated: bicycle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle

- description: cycleway:BACKWARD=lane
  way_id: 49207928
  tags:
    highway: "residential"
    cycleway:right: "lane"
    sidewalk: "both"
  driving_side: left
  road:
    highway: residential
    lanes:
      - type: travel
        designated: foot
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: bicycle
      - type: travel
        designated: foot

- description: cycleway:BACKWARD=lane oneway=yes, cycleway is in the forward direction
  way_id: 428294122
  mapillary: https://www.mapillary.com/app/?pKey=503446704131825
  rust:
    expect_warnings: true
  # https://wiki.openstreetmap.org/wiki/Key:cycleway:right:oneway
  # TODO: OSM tags do not accurately reflect parking situation
  tags:
    highway: "secondary"
    bicycle: "designated"
    lanes: "2"
    oneway: "yes"
    sidewalk: "both"
    cycleway:left: "lane"
  driving_side: right
  ISO 3166-2: US-WA
  road:
    highway: secondary
    lanes:
      - type: travel
        designated: foot
      - type: travel
        direction: forward
        designated: bicycle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        designated: foot

- description: cycleway:FORWARD=lane cycleway:FORWARD:oneway=no
  way_id: 534549104
  mapillary: https://www.mapillary.com/app/?pKey=1848856645291310
  # TODO: find better example with same tags
  tags:
    highway: "tertiary"
    lanes: "2"
    oneway: "yes"
    sidewalk: "both"
    cycleway:right: "track"
    cycleway:right:oneway: "no"
    oneway:bicycle: "no"
  driving_side: right
  road:
    highway: tertiary
    lanes:
      - type: travel
        designated: foot
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: both
        designated: bicycle
      - type: travel
        designated: foot

- description: cycleway=opposite_lane oneway=yes, deprecated
  skip_python: true
  skip_kotlin: true
  rust: false
  tags:
    highway: "road"
    lanes: "1"
    oneway: "yes"
    cycleway: opposite_lane
    sidewalk: "no"
    shoulder: "no"
  driving_side: right
  road:
    highway: road
    lanes:
      - type: travel
        direction: backward
        designated: bicycle
      - type: travel
        direction: forward
        designated: motor_vehicle

- description: cycleway=opposite oneway=yes oneway:bicycle=no
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "1"
    oneway: "yes"
    oneway:bicycle: "no"
    cycleway: opposite
    sidewalk: "no"
    shoulder: "no"
  driving_side: right
  road:
    highway: road
    lanes:
      - type: travel
        direction: backward
        designated: bicycle
      - type: travel
        direction: forward
        designated: motor_vehicle

## TODO: shared cycle lanes

## TODO: cycle tracks

### Bus Lanes

## `busway` Scheme
## https://wiki.openstreetmap.org/wiki/Bus_lanes#The_busway.3D.2A_scheme

- description: busway=lane
  skip_kotlin: true
  skip_python: true
  tags:
    highway: "road"
    lanes: "4"
    sidewalk: "no"
    shoulder: "no"
    busway: lane
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: bus
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: bus

- description: busway:both=lane
  skip_kotlin: true
  skip_python: true
  tags:
    highway: "road"
    lanes: "4"
    sidewalk: "no"
    shoulder: "no"
    busway:both: lane
  driving_side: right
  road:
    highway: road
    lanes:
      - type: travel
        direction: backward
        designated: bus
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: bus

- description: busway:FORWARD=lane
  skip_kotlin: true
  skip_python: true
  tags:
    highway: "road"
    lanes: "3"
    sidewalk: "no"
    shoulder: "no"
    busway:right: lane
  driving_side: right
  road:
    highway: road
    lanes:
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: bus

- description: busway:BACKWARD=lane
  skip_kotlin: true
  skip_python: true
  rust: false
  tags:
    highway: "road"
    lanes: "3"
    sidewalk: "no"
    shoulder: "no"
    busway:right: lane
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: bus

- description: busway=opposite_lane, deprecated
  skip_python: true
  skip_kotlin: true
  rust: false
  tags:
    highway: "road"
    lanes: "2"
    sidewalk: "no"
    shoulder: "no"
    busway: opposite_lane
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: bus

## `bus:lanes` Scheme
## https://wiki.openstreetmap.org/wiki/Bus_lanes#The_bus:lanes.3D.2A_scheme

- description: bus:lanes=designated|
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "2"
    sidewalk: "no"
    shoulder: "no"
    bus:lanes: "designated|"
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: bus
      - type: travel
        direction: backward
        designated: motor_vehicle

- description: psv:lanes=|yes|designated|no
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "4"
    sidewalk: "no"
    shoulder: "no"
    psv:lanes: "|yes|designated|no"
  driving_side: right
  road:
    highway: road
    lanes:
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: bus
      - type: travel
        direction: forward
        designated: motor_vehicle

- description: "bus:lanes:forward=designated|"
  skip_python: true
  skip_kotlin: true
  rust: false # see next test
  tags:
    highway: "road"
    lanes: "3"
    sidewalk: "no"
    shoulder: "no"
    bus:lanes:forward: "designated|"
  driving_side: right
  road:
    highway: road
    lanes:
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: bus
      - type: travel
        direction: forward
        designated: motor_vehicle

- description: "bus:lanes:forward=designated| with lane hint"
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    sidewalk: "no"
    shoulder: "no"
    lanes: "3"
    lanes:forward: "2"
    bus:lanes:forward: "designated|"
  driving_side: right
  road:
    highway: road
    lanes:
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: bus
      - type: travel
        direction: forward
        designated: motor_vehicle

- description: bus:lanes:backward=designated
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "2"
    sidewalk: "no"
    shoulder: "no"
    bus:lanes:backward: "designated"
  driving_side: left
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: bus

## Mixed Schemes

# busway=* and lanes:bus=*
- way_id: 988980354
  description: busway=* and lanes:bus=*
  driving_side: right
  rust:
    expect_warnings: true
  tags:
    highway: primary
    busway: lane
    hgv: local
    lanes:bus: "2"
    lit: "yes"
    maxspeed: 25 mph
    name: East 42nd Street
    sidewalk: both
    surface: asphalt
  road:
    highway: primary
    lanes:
      - type: travel
        designated: foot
      - type: travel
        direction: backward
        designated: bus
        max_speed:
          unit: mph
          value: 25
      - type: travel
        direction: backward
        designated: motor_vehicle
        max_speed:
          unit: mph
          value: 25
      - type: travel
        direction: forward
        designated: motor_vehicle
        max_speed:
          unit: mph
          value: 25
      - type: travel
        direction: forward
        designated: bus
        max_speed:
          unit: mph
          value: 25
      - type: travel
        designated: foot

### Combination
# TODO

### Lifecycle

## Construction
- description: construction
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "construction"
    construction: "road"
    lanes: "1"
    oneway: "yes"
    shoulder: "no"
    sidewalk: "no"
  driving_side: left
  # TODO: nest this so we can check highway type
  road:
    highway: road
    lanes:
      - type: travel
        direction: forward
        designated: motor_vehicle

### To Sort
# The following still need to be categorized

- way_id: 8591383
  mapillary: https://www.mapillary.com/app/?pKey=3963080753774579
  description: a bidirectional cycleway, oneway:bicycle
  # TODO: cycleway tagged as track, but appears to be a lane
  tags:
    highway: tertiary
    lanes: "1"
    oneway: "yes"
    sidewalk: both
    cycleway:left: track
    oneway:bicycle: "no"
  driving_side: right
  ISO 3166-2: US-WA
  output:
    - type: travel
      designated: foot
    - type: travel
      direction: both
      designated: bicycle
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      designated: foot

# A slight variation of the above, using cycleway:left:oneway:no, which should be equivalent
- way_id: 8591383
  mapillary: https://www.mapillary.com/app/?pKey=3963080753774579
  description: a bidirectional cycleway, cycleway:left
  tags:
    highway: tertiary
    lanes: "1"
    oneway: "yes"
    sidewalk: both
    cycleway:left: track
    cycleway:left:oneway: "no"
  driving_side: right
  ISO 3166-2: US-WA
  output:
    - type: travel
      designated: foot
    - type: travel
      direction: both
      designated: bicycle
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      designated: foot

- way_id: 353690151
  mapillary: https://www.mapillary.com/app/?pKey=814030435898295
  # TODO: parking not visible in mapillary
  # TODO: tram line not supported
  tags:
    highway: secondary
    lanes: "4"
    sidewalk: both
    parking:lane:both: parallel
    cycleway:right: track
    cycleway:right:oneway: "no"
  driving_side: right
  ISO 3166-2: US-WA
  output:
    - type: travel
      designated: foot
    - type: parking
      direction: backward
      designated: motor_vehicle
    - type: travel
      direction: backward
      designated: motor_vehicle
    - type: travel
      direction: backward
      designated: motor_vehicle
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: both
      designated: bicycle
    - type: parking
      direction: forward
      designated: motor_vehicle
    - type: travel
      designated: foot

- way_id: 389654080
  mapillary: https://www.mapillary.com/app/?pKey=331760328316020
  # TODO: the cycleway is actually two marked lanes,
  # how should we know that given the tags or what should the tags be?
  tags:
    highway: secondary
    lanes: "2"
    sidewalk: both
    parking:lane:left: parallel
    parking:lane:right: no_stopping
    centre_turn_lane: "yes"
    cycleway:right: track
    cycleway:right:oneway: "no"
  driving_side: right
  ISO 3166-2: US-WA
  output:
    - type: travel
      designated: foot
    - type: parking
      direction: backward
      designated: motor_vehicle
    - type: travel
      direction: backward
      designated: motor_vehicle
    - type: travel
      direction: both
      designated: motor_vehicle
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: both
      designated: bicycle
    - type: travel
      designated: foot

- way_id: 369623526
  # OSM Version #9
  mapillary: https://www.mapillary.com/app/?pKey=839524790321923
  # TODO: check if cycleway:left=opposite_track for RHT is valid, rust disabled
  rust: false
  # TODO: parking lane is not parallel
  tags:
    highway: residential
    lanes: "1"
    oneway: "yes"
    sidewalk: both
    parking:lane:right: diagonal
    cycleway:left: opposite_track
    oneway:bicycle: "no"
  driving_side: right
  ISO 3166-2: US-WA
  output:
    - type: travel
      designated: foot
    - type: travel
      direction: both
      designated: bicycle
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: parking
      direction: forward
      designated: motor_vehicle
    - type: travel
      designated: foot

- way_id: 777565028
  comment: "TODO: image; TODO: example with oneway assumed to be no"
  tags:
    highway: residential
    oneway: "no"
    sidewalk: both
  driving_side: left
  output:
    - type: travel
      designated: foot
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: backward
      designated: motor_vehicle
    - type: travel
      designated: foot

- way_id: 224637155
  mapillary: https://www.mapillary.com/app/?pKey=3687326814728481
  comment: "TODO: missing cycleway:left and busway tags"
  tags:
    highway: primary
    lanes: "2"
    oneway: "yes"
    sidewalk: left
  driving_side: left
  output:
    - type: travel
      designated: foot
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: forward
      designated: motor_vehicle

- description: "3 lanes"
  way_id: 898731283
  comment: "guess that an odd number of lanes will be divided favouring the forward direction with a warning"
  tags:
    highway: "road"
    lanes: "3"
    sidewalk: "both"
  driving_side: "left"
  road:
    highway: road
    lanes:
      - type: travel
        designated: foot
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        designated: foot

# I didn't look for a real example of this
- description: "5 lanes"
  comment: "guess that an odd number of lanes will be divided favouring the forward direction with a warning"
  tags:
    highway: "road"
    lanes: "5"
    sidewalk: "no"
  driving_side: right
  road:
    highway: road
    lanes:
      - type: shoulder
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: shoulder

- description: "lanes, lanes:backward"
  comment: "assume lanes:forward to be lanes - lanes:backward"
  rust: false
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "road"
    lanes: "4"
    lanes:backward: "1"
    sidewalk: "no"
  driving_side: right
  road:
    highway: road
    lanes:
      - type: shoulder
      - type: travel
        direction: backward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: travel
        direction: forward
        designated: motor_vehicle
      - type: shoulder

- description: "a narrow alleyway tagged lanes=1"
  way_id: 335668924
  rust: false
  skip_python: true
  skip_kotlin: true
  tags:
    highway: "service"
    lanes: "1"
  driving_side: right
  road:
    highway: service
    lanes:
      - type: shoulder
      - type: travel
        direction: both
        designated: motor_vehicle
      - type: shoulder

- way_id: 13859146
  rust: false
  tags:
    highway: "secondary"
    busway:both: "lane"
    lanes: "4"
    maxspeed: "50"
    name: Rue Gabriel Péri
    ref: D 986
    surface: asphalt
  driving_side: right
  output:
    - type: travel
      direction: backward
      designated: bus
    - type: travel
      direction: backward
      designated: motor_vehicle
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: forward
      designated: bus

- way_id: 84867915
  rust: false
  tags:
    highway: "secondary"
    busway:right: lane
    cycleway:right: share_busway
    lanes: "2"
    maxspeed: "30"
    name: Boulevard Raspail
    oneway: "yes"
    surface: asphalt
  driving_side: right
  output:
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: forward
      designated: bus

- way_id: 323605308
  rust: false
  tags:
    highway: "primary"
    bus:lanes: "yes|yes|designated"
    busway:right: "lane"
    cycleway:right: "share_busway"
    lanes: "3"
    lanes:psv: "1"
    lit: "yes"
    maxspeed: "30"
    name: "Quai Aimé Césaire"
    oneway: "yes"
    psv:lanes: "yes|yes|designated"
    surface: "asphalt"
    taxi:lanes: "yes|yes|designated"
  driving_side: right
  output:
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: forward
      # TODO: psv?
      designated: bus

- skip_python: true
  skip_kotlin: true
  way_id: 490351863
  rust: false
  tags:
    cycleway:right: share_busway
    highway: secondary
    lanes: "3"
    lanes:psv: "1"
    lit: "yes"
    maxspeed: "50"
    name: Kurfürstendamm
    note: Ergänzungsstraße mit besonderer Bedeutung
    oneway: "yes"
    postal_code: "10719"
    psv:lanes: yes|designated|yes
    sidewalk: right
    surface: asphalt
    turn:lanes: left;through|none|right
    vehicle:lanes: yes|no|yes
    wikidata: Q160272
    wikipedia: de:Kurfürstendamm
  driving_side: right
  output:
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: forward
      designated: bus
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      designated: foot

- skip_python: true
  skip_kotlin: true
  link: https://wiki.openstreetmap.org/wiki/Lanes
  rust: false
  tags:
    lanes: "3"
    oneway: "yes"
    maxspeed:lanes: 100|100|80
  driving_side: right
  output:
    - type: travel
      direction: forward
      designated: motor_vehicle
      max_speed: 100
    - type: travel
      direction: forward
      designated: motor_vehicle
      max_speed: 100
    - type: travel
      direction: forward
      designated: motor_vehicle
      max_speed: 80

- skip_python: true
  skip_kotlin: true
  link: https://wiki.openstreetmap.org/wiki/Bus_lanes
  rust: false
  tags:
    highway: secondary
    oneway: "yes"
    lanes: "3"
    busway:right: lane
    cycleway: share_busway
  driving_side: right
  output:
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: forward
      designated: motor_vehicle
    - type: travel
      direction: forward
      designated: bus

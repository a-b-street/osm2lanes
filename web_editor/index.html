<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

    <style>
      .cards-row {
        display: flex;
        flex-direction: row;
      }

      .card {
        background-color: red;
        margin-left: 15px;
      }

      .card-being-dragged {
        background-color: #c8ebfb;
      }
    </style>

    <link data-trunk rel="rust" href="../osm2lanes-npm/Cargo.toml" />
  </head>
  <body>
    <fieldset>
      <legend>OSM way ID</legend>
      <input type="text" id="osm_way_id" value="804788513" />
    </fieldset>
    <input type="button" value="Edit" onclick="window.start_editing();" />

    <div id="cards" class="cards-row">
      <div class="card">Item 1</div>
      <div class="card">Item 2</div>
      <div class="card">Item 3</div>
      <div class="card">Item 4</div>
      <div class="card">Item 5</div>
      <div class="card">Item 6</div>
    </div>

    <script type="module">
      // TODO THe hash changes, this is very brittle. See https://github.com/thedodd/trunk/issues/230 or stop using trunk.
      import init, {
        js_way_to_lanes,
      } from "./osm2lanes-npm-f84a742dc46ad4d0.js";
      await init();

      new Sortable(document.getElementById("cards"), {
        animation: 150,
        ghostClass: "card-being-dragged",
      });

      async function start_editing() {
        const way = BigInt(document.getElementById("osm_way_id").value);
        console.log(`Fetching ${way}...`);
        let lanes = await js_way_to_lanes(way);
        window.alert(JSON.stringify(lanes, null, 2));
      }
      window.start_editing = start_editing;
    </script>
  </body>
</html>
